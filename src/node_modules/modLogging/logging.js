/**
 * Fire and forget logging module for Kili.us server
 *
 * Author: Jeff Horak
 * Date: 7/6/12
 */

var db = require('../modDatabase/dbService.js');

// Write to the activity log
exports.log = function(payload) {

  db.logActivity(payload).then(
      // Logged successfully, nothing left to do
      null,

      // There was an error logging the activity
      function(err) {

        // Need to write to the error log
        exports.logError({
          message: 'Database error writing to the activity log',
          error: err.error,
          code: err.code
        })
      }
  );
}

exports.logError = function(payload) {

  db.logError(payload).then(
      // Logged successfully, nothing left to do
      null,

      // There was an error writing to the error log, throw
      function(err) {
        throw err;
      }
  );
}