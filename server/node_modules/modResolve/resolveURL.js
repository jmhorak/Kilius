//////////////////////////////////////////////////////////////////////////
// File: resolveURL.js
//
// Description: 
//   Resolves a URL from the server backend
//
//////////////////////////////////////////////////////////////////////////

/**
 * Resolves the given URL to the address to forward to
 *
 * @param urlStr - String to lookup
 * @param redirectCallback - Callback when successfully resolved
 * @param errorCallback - Callback when there is a problem
 */
exports.resolveURL = function (urlStr, redirectCallback, errorCallback) {
  var mysql = require('mysql'),
      databaseName = 'kilius',
      mapTable = 'linkmap',
      user = 'kilius',
      password = null,
      client = mysql.createClient({
                 user: user,
                 password: password,
                 database: databaseName
               });

  client.query(
    'SELECT value FROM ' + mapTable + ' WHERE key = ?',
     [urlStr],
     function (err, results, fields) {
       if (err) {
         errorCallback(err);
       } else {
         console.log(results);
         console.log(fields);
       }

       client.end();
     }
  );
}